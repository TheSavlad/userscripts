(()=>{const e=function(){const e=window.ozon,{$:t,$$:o,error:r,log:n,dom:s}=e,a=0,i=4,d=5,l=0,c=1,f=2,p=3,h="Ð¾Ñ‚Ð¼ÐµÐ½Ñ‘Ð½,Ð² ÑÐ±Ð¾Ñ€ÐºÐµ,Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‘Ñ‚ÑÑ,Ð² Ð¿ÑƒÑ‚Ð¸,Ð¾Ð¶Ð¸Ð´Ð°ÐµÑ‚,Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½,Ð² ÑÐ»ÑƒÐ¶Ð±Ðµ".split(","),u="ÑÐ½Ð²Ð°Ñ€,Ñ„ÐµÐ²Ñ€Ð°Ð»,Ð¼Ð°Ñ€Ñ‚,Ð°Ð¿Ñ€ÐµÐ»,Ð¼Ð°,Ð¸ÑŽÐ½,Ð¸ÑŽÐ»,Ð°Ð²Ð³ÑƒÑÑ‚,ÑÐµÐ½Ñ‚ÑÐ±Ñ€,Ð¾ÐºÑ‚ÑÐ±Ñ€,Ð½Ð¾ÑÐ±Ñ€,Ð´ÐµÐºÐ°Ð±Ñ€".split(","),m={[a]:"ðŸ›‘ ÐžÑ‚Ð¼ÐµÐ½Ñ‘Ð½",1:"âŒ› Ð’ ÑÐ±Ð¾Ñ€ÐºÐµ",2:"ðŸ“¦ ÐŸÐµÑ€ÐµÐ´Ð°Ñ‘Ñ‚ÑÑ",6:"ðŸ“¦ Ð’ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐµ",3:"ðŸšš Ð’ Ð¿ÑƒÑ‚Ð¸",[i]:"âš ï¸ ÐžÐ¶Ð¸Ð´Ð°ÐµÑ‚",[d]:"âœ… ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½"},g=[{"body #layoutPage>div>[data-widget=wallpaper]":{"margin-top":"179px"},".ozon-helper-orders":{left:"0px",right:"0px","background-color":"#FFFFFF","border-bottom":"1px solid #E0E6EF",display:"flex","overflow-x":"scroll",gap:"5px",padding:"5px"},".ozon-helper-orders.fixed":{position:"fixed",top:"63px"},".ozon-helper-orders.absolute":{position:"absolute",top:"132px"},".ozon-order":{display:"flex","flex-direction":"column","align-items":"center",border:"1px solid #E0E6EF",padding:"3px"},".ozon-order-ready":{animation:"1s infinite alternate ozon-blink","background-color":"currentcolor","box-shadow":"0px 0px 10px currentcolor"},".ozon-order-ready .ozon-item-state-name":{border:"none",color:"black"},".ozon-order-items":{display:"flex",gap:"3px"},".ozon-item":{display:"flex","flex-direction":"column","align-items":"center",gap:"3px"},".ozon-item-state-name":{"border-bottom":"1px solid #E0E6EF","padding-bottom":"3px"},".ozon-order a":{"min-width":"100px","max-width":"100px","min-height":"100px","max-height":"100px",display:"flex","justify-content":"center","align-items":"center"},".ozon-order a>img":{"max-width":"100%","max-height":"100%"},".ozon-order-divider":{"min-width":"5px","min-height":"100%","background-color":"#E0E6EF"}},"@keyframes ozon-blink {","    0% { background-color: hsl(45, 80%, 50%); box-shadow: 0px 0px 10px hsl(45, 80%, 40%); }","   10% { background-color: hsl(45, 80%, 50%); box-shadow: 0px 0px 10px hsl(45, 80%, 40%); }","   80% { background-color: hsl(45, 80%, 80%); box-shadow: 0px 0px  2px hsl(45, 80%, 40%); }","  100% { background-color: hsl(45, 80%, 80%); box-shadow: 0px 0px  2px hsl(45, 80%, 40%); }","}"],x={header:"",paginator:"",order:"",orderState:""};function w(e){return Object.values(e?.classList||[]).map((e=>`.${e}`)).join("")}function b(e,o){if(!e)return r("invalid order item element");if("A"!==e.tagName)return r("element not <a>:",e);const n=e,s={href:"",src:"",state:o.state,stateName:""};if(s.stateName=m[o.state],s.href=n.href,!s.href)return r("no href for",n);const a=t(n,"img");return a?(s.src=a.src,s.src?s:r("no src for",a)):r("no img for",n)}function v(s){const a={day:0,month:0,date:"?",state:-1,items:[]};if(function(o,n){const s=t(o,x.orderState);if(!s)return r("state element not found for",o);const a=s.innerText.toLowerCase(),i=e.findMany(a,h);return i<0?r("unknown state in",s):(n.state=i,!0)}(s,a)&&function(o,n){let s=null;if(n.state===i){const e=t(o,"svg");e&&(s=e.previousElementSibling)}if(s||(s=t(o,"p")),!s)return r("date element not found for",o);const a=/(\d+) ([Ð°-ÑÑ‘]+)/.exec(s.innerText.trim());if(!a)return!!s.innerText.includes("ÑƒÑ‚Ð¾Ñ‡Ð½")||r("invalid date string in",s);const[d,l,c]=a;return n.date=d,n.day=+l,isNaN(n.day)?r("invalid day in",s):(n.month=e.findMany(c.toLowerCase(),u),n.month<0?r("unknown month in",s):(n.state===i&&(n.date=`Ð´Ð¾ ${n.date}`),!0))}(s,a)){for(const e of o(s,"a>img")){const t=b(e.parentElement,a);t&&a.items.push(t)}return n("order:",a),a}}function y(e){e.appendChild(s("div",{className:"ozon-order-divider"}))}function z(e,t,o){t.sort(o("index")).forEach((t=>function(e,t){const o=["ozon-order"];e.state===p&&o.push("ozon-order-ready");const r=s("div",{className:o.join(" ")},s("div",{className:"ozon-order-items"},e.orders.map((e=>s("div",{className:"ozon-item"},s("a",{href:e.href},s("img",{loading:"lazy",fetchPriority:"low",src:e.src})),s("div",{className:"ozon-item-state"},s("div",{className:"ozon-item-state-name"},e.stateName)))))),s("div",{className:"ozon-order-date"},e.str));r.dataset.state=e.state,t.appendChild(r)}(t,e)))}function E(t,s){n("updating orders");const h=function(e){const t=[];for(const r of o(e,x.order)){const e=v(r);e&&t.push(e)}return t}(t);n(h.length,"orders found");const u=function(t){const o={};for(const e of t){const t=[];for(const o of e.items)o.state!==a&&t.push(o);0!==t.length&&(o[e.date]||(o[e.date]={day:e.day,mon:e.month,str:e.date,state:-1,index:+[1,String(e.month).padStart(2,"0"),String(e.day).padStart(2,"0")].join(""),orders:[]}),o[e.date].orders.push(...t))}for(const e of Object.values(o))e.state=f,e.orders.some((e=>e.state===i))?e.state=p:e.orders.every((e=>e.state===d))?e.state=c:e.orders.every((e=>e.state===a))&&(e.state=l);return Object.values(o).sort(e.desc("state"))}(h);n("groups:",u);const[m,g,w]=function(e){const t=[],o=[],n=[];for(const s of e){if(s.state===l)continue;const e={[c]:n,[f]:o,[p]:t}[s.state];e?e.push(s):r("unknown group category for:",s)}return[n,o,t]}(u);for(;s.firstChild;)s.firstChild.remove();const b=w.length,E=g.length,k=m.length,N=b+E,F=E+k;z(s,w,e.asc),b>0&&F>0&&y(s),z(s,g,e.asc),N>0&&k>0&&y(s),z(s,m,e.desc)}function k(e,t){n("updating header");const o=e.classList.length>1;n("header is sticky =",o),t.classList.toggle("fixed",o),t.classList.toggle("absolute",!o)}return function(){e.css(...g),function(){x.header='[data-widget="header"]>div:first-child',x.paginator='[data-widget="paginator"]>div';const e=t("[data-widget=orderList]");if(!e)throw new Error("order list not found");const o=t(e,"img");if(!o)throw new Error("order image not found");const r=Array.from(e.firstElementChild?.children??[]);let s=o.parentElement;for(;s!==e;){if(!s)throw new Error("no parent element");if(r.includes(s)){x.order=w(s.firstElementChild);break}s=s.parentElement}if(!x.order)throw new Error("order selector not found");x.order=`[data-widget="orderList"] ${x.order}`;const a=t(e,x.order);if(!a)throw new Error("order selector failed");let i=t(a,"div>span+svg")?.previousElementSibling;if(!i&&(i=t(a,"div>span:first-child:last-child"),!i))throw new Error("order state selector failed");x.orderState=w(i),n("selectors =",x)}();const o=t(x.header);if(!o)return r("sticky header not found");n("stickyHeader =",o);const a=t("[data-widget=paginator]>div");if(!a)return r("paginator not found");n("paginator =",a);const i=s("div",{className:"ozon-helper-orders"});i.addEventListener("wheel",(e=>{i.scrollBy({left:e.deltaY,behavior:"smooth"}),e.preventDefault()})),document.body.appendChild(i),n("container created:",i),e.observe(o,{attributes:!0},(()=>k(o,i))),n("observing header"),k(o,i),e.observe(a,{childList:!0},(()=>E(a,i))),n("observing paginator"),E(a,i)}}();window.ozon.orderlist=e})();
